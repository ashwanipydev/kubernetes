<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kubernetes Learning Journey: From Zero to DevOps Hero</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        
        /* Chart Container Styling - Mandatory Requirements */
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 300px; /* Mobile base height */
            max-height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 350px; /* Tablet/Desktop height */
            }
        }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f5f9;
        }
        ::-webkit-scrollbar-thumb {
            background: #94a3b8;
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #64748b;
        }

        /* Interactive Element Transitions */
        .interactive-card {
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .interactive-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }

        /* Active Navigation State */
        .nav-item.active {
            background-color: #eff6ff;
            color: #2563eb;
            border-right: 3px solid #2563eb;
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-800 h-screen overflow-hidden flex flex-col">

    <!-- Chosen Palette: Kubernetes Blue & Slate Neutral -->
    <!-- 
         Primary: #326CE5 (Kubernetes Blue) -> Tailwind blue-600
         Background: #F8FAFC (Slate 50)
         Text: #1E293B (Slate 800)
         Accent: #0EA5E9 (Sky Blue)
    -->

    <!-- Application Structure Plan: 
         - **Layout**: Dashboard style. Left sidebar for the 12-Day Timeline navigation. Main content area for dynamic day details.
         - **Dashboard Home**: Overview of the 4 phases, total progress, and command proficiency stats (Chart.js).
         - **Day View**: When a day is selected, the main area splits into tabs:
           1. **Concepts**: Interactive diagrams (HTML/CSS) and theory.
           2. **Command Lab**: List of specific kubectl commands for that day with copy functionality.
           3. **Practice & Scenarios**: Checklists for hands-on tasks and interactive "Flip Cards" for Real-World Scenarios/Mistakes.
         - **Interactivity**: Users can "Mark Complete" days to update the global progress chart. 
         - **Rationale**: The 12-day plan is linear but complex. A dashboard allows users to jump between days while maintaining a sense of progression. Splitting content into tabs prevents information overload.
    -->

    <!-- Visualization & Content Choices:
         - **Progress Ring (Dashboard)**: Chart.js Doughnut. Goal: Inform/Motivate. Shows % of plan completed.
         - **Command Skill Distribution (Dashboard)**: Chart.js Bar. Goal: Compare. Shows count of Beginner vs Advanced commands learned.
         - **Interactive Cards**: HTML/JS. Goal: Inform/Engage. Used for Common Mistakes and Scenarios to encourage active clicking.
         - **Concept Blocks**: Styled Divs. Goal: Inform. Visualizing K8s Architecture using nested flexboxes (Node > Pod > Container).
    -->

    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->

    <!-- Header -->
    <header class="bg-white border-b border-slate-200 h-16 flex items-center justify-between px-6 shrink-0 z-20 shadow-sm">
        <div class="flex items-center gap-3">
            <div class="w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center text-white font-bold text-lg">K8</div>
            <h1 class="text-xl font-bold tracking-tight text-slate-900">Kubernetes Hero Journey</h1>
        </div>
        <div class="flex items-center gap-4">
            <span class="text-sm text-slate-500 hidden md:inline">12-Day Intensive Plan</span>
            <button onclick="resetProgress()" class="text-xs text-red-500 hover:text-red-700 underline">Reset Progress</button>
        </div>
    </header>

    <div class="flex flex-1 overflow-hidden">
        <!-- Sidebar Navigation -->
        <aside class="w-64 bg-white border-r border-slate-200 overflow-y-auto hidden md:block shrink-0 flex flex-col">
            <div class="p-4">
                <h2 class="text-xs font-semibold text-slate-400 uppercase tracking-wider mb-3">Curriculum Timeline</h2>
                <div id="nav-container" class="space-y-6">
                    <!-- Navigation dynamically populated -->
                </div>
            </div>
        </aside>

        <!-- Main Content Area -->
        <main id="main-content" class="flex-1 overflow-y-auto p-6 md:p-8 relative">
            <!-- Content dynamically populated -->
        </main>
    </div>

    <!-- Mobile Nav Toggle (Visible only on small screens) -->
    <div class="md:hidden fixed bottom-4 right-4 z-50">
        <button id="mobile-menu-btn" class="bg-blue-600 text-white p-3 rounded-full shadow-lg" onclick="toggleMobileNav()">
            Menu
        </button>
    </div>
    
    <!-- Mobile Sidebar Modal -->
    <div id="mobile-sidebar" class="fixed inset-0 bg-slate-900 bg-opacity-50 z-40 hidden" onclick="toggleMobileNav()">
        <div class="bg-white w-64 h-full overflow-y-auto" onclick="event.stopPropagation()">
            <div class="p-4 border-b">
                <h2 class="font-bold text-lg">Navigation</h2>
            </div>
            <div id="mobile-nav-container" class="p-4 space-y-4">
                <!-- Mobile Nav items -->
            </div>
        </div>
    </div>

    <!-- Data & Logic -->
    <script>
        // --- Source Data ---
        const curriculum = {
            overview: {
                title: "Dashboard Overview",
                description: "Track your progress from beginner to production-ready operations.",
                phases: [
                    { id: 1, title: "The Foundation", days: "1-3", color: "border-l-4 border-blue-500" },
                    { id: 2, title: "Networking & Config", days: "4-6", color: "border-l-4 border-indigo-500" },
                    { id: 3, title: "Advanced Workloads", days: "7-9", color: "border-l-4 border-purple-500" },
                    { id: 4, title: "Production & Ops", days: "10-12", color: "border-l-4 border-emerald-500" }
                ]
            },
            days: [
                {
                    day: 1,
                    phase: 1,
                    title: "Architecture & Cluster Setup",
                    goal: "Understand K8s internals and verify cluster connectivity.",
                    concepts: [
                        { title: "Control Plane (Brain)", content: "Manages the cluster. Includes: API Server (Gatekeeper), etcd (Memory), Scheduler (Planner), Controller Manager." },
                        { title: "Worker Nodes (Muscle)", content: "Runs applications. Includes: Kubelet (Agent), Kube-proxy (Network), Container Runtime (Docker)." },
                        { title: "Declarative Model", content: "You tell K8s 'Desired State' (I want 3 pods), K8s works to match 'Current State' to it." }
                    ],
                    commands: [
                        { cmd: "kubectl version", level: "Beginner", desc: "Check client and server version." },
                        { cmd: "kubectl cluster-info", level: "Beginner", desc: "Verify control plane location." },
                        { cmd: "kubectl get nodes", level: "Beginner", desc: "List worker nodes and status." },
                        { cmd: "kubectl api-resources", level: "Advanced", desc: "List all available resource types." }
                    ],
                    practice: [
                        "Install Minikube or Kind.",
                        "Start the cluster.",
                        "Run 'kubectl get nodes' to verify readiness.",
                        "Inspect ~/.kube/config file."
                    ],
                    scenario: {
                        problem: "You join a new company. They give you access to a cluster. What's the first step?",
                        solution: "Verify connection using 'kubectl version' and check capacity with 'kubectl get nodes'."
                    },
                    mistakes: ["Confusing Client Version (laptop) with Server Version (cluster).", "Docker daemon not running before starting Minikube."]
                },
                {
                    day: 2,
                    phase: 1,
                    title: "The Atom: Pods",
                    goal: "Run your first containerized application.",
                    concepts: [
                        { title: "Pod", content: "Smallest deployable unit. Usually 1 container per pod." },
                        { title: "YAML", content: "The configuration language of Kubernetes." },
                        { title: "Lifecycle", content: "Pending -> Running -> Succeeded/Failed/CrashLoopBackOff." }
                    ],
                    commands: [
                        { cmd: "kubectl run nginx --image=nginx", level: "Beginner", desc: "Imperatively start a pod." },
                        { cmd: "kubectl get pods", level: "Beginner", desc: "List pods in current namespace." },
                        { cmd: "kubectl get pods -o wide", level: "Intermediate", desc: "See IP and Node assignment." },
                        { cmd: "kubectl describe pod <name>", level: "Beginner", desc: "Detailed inspection & events." },
                        { cmd: "kubectl logs <name>", level: "Beginner", desc: "View application logs." },
                        { cmd: "kubectl apply -f pod.yaml", level: "Beginner", desc: "Create from file." },
                        { cmd: "kubectl delete -f pod.yaml", level: "Beginner", desc: "Delete from file." }
                    ],
                    practice: [
                        "Create 'my-pod.yaml' for Nginx.",
                        "Apply with 'kubectl apply -f'.",
                        "Force failure (wrong image tag) and debug with 'describe'.",
                        "View logs of running pod."
                    ],
                    scenario: {
                        problem: "Developer says 'My app isn't starting'.",
                        solution: "1. 'kubectl get pods' (Check status). 2. 'kubectl describe pod' (Check Events). 3. 'kubectl logs' (Check app output)."
                    },
                    mistakes: ["Using 'run' for production instead of YAML.", "Ignoring the 'Events' section in describe output."]
                },
                {
                    day: 3,
                    phase: 1,
                    title: "Controllers: Deployments",
                    goal: "Ensure high availability and manage updates.",
                    concepts: [
                        { title: "ReplicaSet", content: "Ensures X copies of a pod are running." },
                        { title: "Deployment", content: "Manages ReplicaSets. Handles rolling updates and rollbacks." },
                        { title: "Labels", content: "Key/Value pairs used to identify and select subsets of objects." }
                    ],
                    commands: [
                        { cmd: "kubectl create deployment web --image=nginx --replicas=3", level: "Beginner", desc: "Create deployment." },
                        { cmd: "kubectl scale deployment web --replicas=5", level: "Intermediate", desc: "Manually scale up." },
                        { cmd: "kubectl rollout status deployment web", level: "Intermediate", desc: "Watch update progress." },
                        { cmd: "kubectl rollout undo deployment web", level: "Intermediate", desc: "Revert bad update." }
                    ],
                    practice: [
                        "Create deployment.yaml with 3 replicas.",
                        "Delete a pod manually and watch it respawn.",
                        "Update image to 'nginx:latest' and watch rollout.",
                        "Rollback using 'undo'."
                    ],
                    scenario: {
                        problem: "Deployed v2 but it has a critical bug. Downtime is expensive.",
                        solution: "Immediately run 'kubectl rollout undo deployment <name>' to revert to v1."
                    },
                    mistakes: ["Editing pods directly instead of the Deployment.", "Not setting resource limits (hogging cluster RAM)."]
                },
                {
                    day: 4,
                    phase: 2,
                    title: "Networking: Services",
                    goal: "Expose your application to the network.",
                    concepts: [
                        { title: "ClusterIP", content: "Internal only. Default service type." },
                        { title: "NodePort", content: "Exposes port on every worker node IP (Static port)." },
                        { title: "LoadBalancer", content: "Uses Cloud Provider's LB (AWS/GCP/Azure)." }
                    ],
                    commands: [
                        { cmd: "kubectl get svc", level: "Beginner", desc: "List services." },
                        { cmd: "kubectl expose deployment web --port=80 --type=NodePort", level: "Intermediate", desc: "Expose via CLI." },
                        { cmd: "kubectl port-forward svc/web 8080:80", level: "Intermediate", desc: "Access internal svc locally." }
                    ],
                    practice: [
                        "Deploy backend app.",
                        "Create ClusterIP service (try accessing -> fail).",
                        "Use 'port-forward' to access it.",
                        "Switch to NodePort and access via NodeIP."
                    ],
                    scenario: {
                        problem: "Frontend needs to talk to Backend inside the cluster.",
                        solution: "Create a Service for Backend. Frontend calls 'http://backend-service-name'."
                    },
                    mistakes: ["Confusing Port (Service) vs TargetPort (Container).", "Mismatched Labels in Service Selector."]
                },
                {
                    day: 5,
                    phase: 2,
                    title: "ConfigMaps & Secrets",
                    goal: "Decouple configuration from application code.",
                    concepts: [
                        { title: "ConfigMap", content: "Non-sensitive data (URLs, flags)." },
                        { title: "Secret", content: "Sensitive data (Passwords). Base64 encoded." },
                        { title: "Injection", content: "Can be Environment Variables or Mounted Volumes." }
                    ],
                    commands: [
                        { cmd: "kubectl create configmap app-cfg --from-literal=ENV=prod", level: "Intermediate", desc: "Create CM." },
                        { cmd: "kubectl create secret generic app-sec --from-literal=pass=123", level: "Intermediate", desc: "Create Secret." },
                        { cmd: "kubectl explain pod.spec.containers.env", level: "Intermediate", desc: "Find YAML syntax." }
                    ],
                    practice: [
                        "Create ConfigMap with custom HTML.",
                        "Mount it to Nginx /usr/share/nginx/html.",
                        "Inject DB password as Env Var from Secret."
                    ],
                    scenario: {
                        problem: "Deploying same app to Dev and Prod with different DB URLs.",
                        solution: "Same Deployment YAML, but reference different ConfigMaps for Dev/Prod."
                    },
                    mistakes: ["Committing secrets to Git.", "Expecting live updates for Env Vars (requires restart)."]
                },
                {
                    day: 6,
                    phase: 2,
                    title: "Namespaces & Limits",
                    goal: "Organize the cluster and prevent resource hogging.",
                    concepts: [
                        { title: "Namespaces", content: "Virtual clusters (dev, prod, team-a)." },
                        { title: "Requests", content: "Minimum CPU/RAM guaranteed." },
                        { title: "Limits", content: "Max CPU/RAM allowed. Pod killed if RAM exceeded." }
                    ],
                    commands: [
                        { cmd: "kubectl create namespace dev", level: "Beginner", desc: "Create NS." },
                        { cmd: "kubectl get pods -n dev", level: "Beginner", desc: "List pods in NS." },
                        { cmd: "kubectl config set-context --current --namespace=dev", level: "Intermediate", desc: "Switch default NS." },
                        { cmd: "kubectl top pods", level: "Advanced", desc: "Check resource usage." }
                    ],
                    practice: [
                        "Create 'marketing' namespace.",
                        "Deploy app with CPU/Memory limits.",
                        "Install Metrics Server.",
                        "Run 'kubectl top pods'."
                    ],
                    scenario: {
                        problem: "Java app has memory leak, crashes the whole node.",
                        solution: "Apply Resource Limits. Only the specific pod dies, node stays healthy."
                    },
                    mistakes: ["Deploying everything to 'default'.", "Not setting limits (Noisy Neighbors)."]
                },
                {
                    day: 7,
                    phase: 3,
                    title: "Storage: PV & PVC",
                    goal: "Persist data so it survives Pod restarts.",
                    concepts: [
                        { title: "PersistentVolume (PV)", content: "Physical storage resource (Disk, EBS)." },
                        { title: "PersistentVolumeClaim (PVC)", content: "Request/Ticket for storage." },
                        { title: "StorageClass", content: "Dynamic provisioning magic." }
                    ],
                    commands: [
                        { cmd: "kubectl get sc", level: "Intermediate", desc: "List storage classes." },
                        { cmd: "kubectl get pvc", level: "Intermediate", desc: "List claims." },
                        { cmd: "kubectl describe pvc <name>", level: "Intermediate", desc: "Debug binding issues." }
                    ],
                    practice: [
                        "Deploy MySQL pod.",
                        "Create PVC requesting 1Gi.",
                        "Mount PVC to /var/lib/mysql.",
                        "Add data, delete pod, verify data persists."
                    ],
                    scenario: {
                        problem: "Database node crashes. Data lost?",
                        solution: "With PVC, new pod starts on healthy node, re-attaches drive. Data safe."
                    },
                    mistakes: ["Using 'hostPath' in production (stuck on one node).", "ReadWriteOnce limitation ignored."]
                },
                {
                    day: 8,
                    phase: 3,
                    title: "StatefulSets & DaemonSets",
                    goal: "Run databases and system agents.",
                    concepts: [
                        { title: "StatefulSet", content: "For DBs. Stable IDs (web-0, web-1). Ordered deployment." },
                        { title: "DaemonSet", content: "Runs one pod on EVERY node (Logs, Monitoring)." }
                    ],
                    commands: [
                        { cmd: "kubectl get statefulsets", level: "Intermediate", desc: "List StatefulSets." },
                        { cmd: "kubectl get ds", level: "Intermediate", desc: "List DaemonSets." },
                        { cmd: "kubectl delete pod web-0", level: "Intermediate", desc: "Watch it return with same name." }
                    ],
                    practice: [
                        "Deploy node-exporter as DaemonSet.",
                        "Deploy dummy stateful app.",
                        "Observe stable naming convention."
                    ],
                    scenario: {
                        problem: "Need to collect logs from every server.",
                        solution: "Deploy Fluentd/Fluentbit as a DaemonSet."
                    },
                    mistakes: ["Using Deployments for databases (Identity matters!)."]
                },
                {
                    day: 9,
                    phase: 3,
                    title: "Ingress & Health",
                    goal: "Production routing and self-healing.",
                    concepts: [
                        { title: "Ingress", content: "L7 Routing (HTTP/HTTPS). Host or Path based." },
                        { title: "Liveness Probe", content: "Restart me if I crash." },
                        { title: "Readiness Probe", content: "Don't send traffic until I'm ready." }
                    ],
                    commands: [
                        { cmd: "kubectl get ingress", level: "Intermediate", desc: "List rules." },
                        { cmd: "kubectl describe ingress", level: "Intermediate", desc: "Check backend IP mapping." },
                        { cmd: "kubectl logs -n ingress-nginx <pod>", level: "Advanced", desc: "Debug controller." }
                    ],
                    practice: [
                        "Install Nginx Ingress Controller.",
                        "Create ingress.yaml for example.local.",
                        "Add Readiness Probe to deployment."
                    ],
                    scenario: {
                        problem: "App loads but returns 502 Bad Gateway.",
                        solution: "Check Readiness Probe. If failing, Service removes pod from LB."
                    },
                    mistakes: ["Missing Ingress Controller.", "Aggressive Liveness probes causing restart loops."]
                },
                {
                    day: 10,
                    phase: 4,
                    title: "Security: RBAC",
                    goal: "Control who can do what.",
                    concepts: [
                        { title: "Role", content: "Permissions (What can be done?)." },
                        { title: "RoleBinding", content: "Assignment (Who can do it?)." },
                        { title: "ServiceAccount", content: "Identity for bots/pods." }
                    ],
                    commands: [
                        { cmd: "kubectl create serviceaccount my-app", level: "Intermediate", desc: "Create bot identity." },
                        { cmd: "kubectl auth can-i create pods", level: "Advanced", desc: "Test permissions." },
                        { cmd: "kubectl auth can-i ... --as=system:...", level: "Advanced", desc: "Impersonate user." }
                    ],
                    practice: [
                        "Create Role 'pod-reader'.",
                        "Bind to a user.",
                        "Try to delete pod as that user (Should fail)."
                    ],
                    scenario: {
                        problem: "CI/CD pipeline needs permission to deploy.",
                        solution: "Create ServiceAccount, limited Role (deploy only), generate token."
                    },
                    mistakes: ["Giving 'cluster-admin' to everyone."]
                },
                {
                    day: 11,
                    phase: 4,
                    title: "Autoscaling & Helm",
                    goal: "Automation and Package Management.",
                    concepts: [
                        { title: "HPA", content: "Horizontal Pod Autoscaler. Scales on CPU/RAM." },
                        { title: "Helm", content: "Package manager (apt/yum for K8s). Templates YAML." }
                    ],
                    commands: [
                        { cmd: "kubectl autoscale deployment web ...", level: "Intermediate", desc: "Create HPA." },
                        { cmd: "kubectl get hpa", level: "Intermediate", desc: "Check scaling status." },
                        { cmd: "helm install my-release bitnami/nginx", level: "Advanced", desc: "Install chart." }
                    ],
                    practice: [
                        "Install Helm.",
                        "Deploy Redis via Helm.",
                        "Setup HPA for Nginx.",
                        "Generate load, watch scaling."
                    ],
                    scenario: {
                        problem: "Black Friday traffic spike.",
                        solution: "HPA detects high CPU, scales from 2 -> 20 pods automatically."
                    },
                    mistakes: ["Not setting resource requests (HPA needs them to calculate %)."]
                },
                {
                    day: 12,
                    phase: 4,
                    title: "Troubleshooting & Capstone",
                    goal: "Think like an SRE.",
                    concepts: [
                        { title: "Node Maintenance", content: "Draining nodes for upgrades." },
                        { title: "Debugging", content: "Ephemeral containers, Events timeline." }
                    ],
                    commands: [
                        { cmd: "kubectl drain <node>", level: "Advanced", desc: "Evict all pods." },
                        { cmd: "kubectl debug -it pod/<name> ...", level: "Advanced", desc: "Attach debug container." },
                        { cmd: "kubectl get events --sort-by=...", level: "Advanced", desc: "Chronological errors." }
                    ],
                    practice: [
                        "Use 'drain' and 'uncordon'.",
                        "Debug a crashed pod.",
                        "CAPSTONE: Deploy prod-ready microservice (Namespace, Config, Storage, Ingress, HPA, Security)."
                    ],
                    scenario: {
                        problem: "Capstone Project",
                        solution: "Deploy a full stack app implementing all concepts from Days 1-11."
                    },
                    mistakes: ["Ignoring 'diff' before applying changes."]
                }
            ]
        };

        // --- State Management ---
        let currentDayId = null; // null means dashboard
        let progress = JSON.parse(localStorage.getItem('k8s_hero_progress')) || new Array(12).fill(false);

        // --- DOM Elements ---
        const mainContent = document.getElementById('main-content');
        const navContainer = document.getElementById('nav-container');
        const mobileNavContainer = document.getElementById('mobile-nav-container');

        // --- Initialization ---
        function init() {
            renderNav();
            loadDashboard(); // FIX: Changed from renderDashboard to loadDashboard
        }

        // --- Navigation Logic ---
        function renderNav() {
            const phases = curriculum.overview.phases;
            let html = '';
            
            phases.forEach(phase => {
                html += `
                    <div class="mb-4">
                        <div class="text-sm font-bold text-slate-700 mb-2 pl-2 ${phase.color} flex justify-between items-center">
                            <span>Phase ${phase.id}: ${phase.title}</span>
                        </div>
                        <ul class="space-y-1">
                `;
                
                const phaseDays = curriculum.days.filter(d => d.phase === phase.id);
                phaseDays.forEach(day => {
                    const isCompleted = progress[day.day - 1];
                    const activeClass = currentDayId === day.day ? 'active' : 'hover:bg-slate-50 text-slate-600';
                    const checkMark = isCompleted ? '<span class="text-green-500">âœ“</span>' : `<span class="text-slate-300 text-xs">${day.day}</span>`;
                    
                    html += `
                        <li>
                            <button onclick="loadDay(${day.day})" class="nav-item w-full text-left px-3 py-2 rounded-md text-sm transition-colors flex items-center gap-3 ${activeClass}">
                                ${checkMark}
                                <span class="truncate">Day ${day.day}: ${day.title}</span>
                            </button>
                        </li>
                    `;
                });

                html += `</ul></div>`;
            });

            // Dashboard Link
            const dashboardActive = currentDayId === null ? 'bg-blue-50 text-blue-700 font-bold' : 'text-slate-600 hover:bg-slate-50';
            const dashboardHtml = `
                <button onclick="loadDashboard()" class="w-full text-left px-3 py-2 rounded-md mb-6 text-sm flex items-center gap-3 ${dashboardActive}">
                    <span>ðŸ“Š</span>
                    <span>Dashboard Overview</span>
                </button>
            `;

            navContainer.innerHTML = dashboardHtml + html;
            mobileNavContainer.innerHTML = dashboardHtml + html;
        }

        function toggleMobileNav() {
            const el = document.getElementById('mobile-sidebar');
            el.classList.toggle('hidden');
        }

        function resetProgress() {
            // Using a simple modal/custom dialog instead of alert/confirm
            const proceed = window.confirm("Resetting progress will clear all completed days. Are you sure you want to reset all learning progress?");
            if (proceed) {
                progress = new Array(12).fill(false);
                saveProgress();
                renderNav();
                if(currentDayId === null) loadDashboard();
                else loadDay(currentDayId);
            }
        }

        function saveProgress() {
            localStorage.setItem('k8s_hero_progress', JSON.stringify(progress));
        }

        function toggleDayCompletion(dayIndex) {
            progress[dayIndex] = !progress[dayIndex];
            saveProgress();
            renderNav();
            loadDay(dayIndex + 1); // Reload to update UI state
        }

        // --- View: Dashboard ---
        function loadDashboard() {
            currentDayId = null;
            renderNav();

            // Calculate Stats
            const completedCount = progress.filter(Boolean).length;
            const percentage = Math.round((completedCount / 12) * 100);
            
            // Calculate Command Stats
            let beginner = 0, intermediate = 0, advanced = 0;
            // Only count commands for completed days? Or all? Let's show TOTAL available vs Completed
            // Let's show "Commands Unlocked" based on completed days
            curriculum.days.forEach((d, idx) => {
                if(progress[idx]) {
                    d.commands.forEach(c => {
                        if(c.level === 'Beginner') beginner++;
                        if(c.level === 'Intermediate') intermediate++;
                        if(c.level === 'Advanced') advanced++;
                    });
                }
            });

            mainContent.innerHTML = `
                <div class="max-w-4xl mx-auto animate-fade-in">
                    <div class="mb-8">
                        <h2 class="text-3xl font-bold text-slate-900 mb-2">Welcome, Future DevOps Hero.</h2>
                        <p class="text-slate-600">Your 12-day path to Kubernetes mastery. Select a day to begin learning.</p>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                        <!-- Progress Card -->
                        <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-200">
                            <h3 class="font-semibold text-slate-800 mb-4">Overall Progress</h3>
                            <div class="chart-container flex justify-center items-center">
                                <canvas id="progressChart"></canvas>
                            </div>
                            <div class="text-center mt-4">
                                <span class="text-4xl font-bold text-blue-600">${percentage}%</span>
                                <span class="text-slate-400 text-sm block">Curriculum Completed</span>
                            </div>
                        </div>

                        <!-- Skill Card -->
                        <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-200">
                            <h3 class="font-semibold text-slate-800 mb-4">Commands Unlocked</h3>
                            <div class="chart-container">
                                <canvas id="skillChart"></canvas>
                            </div>
                            <p class="text-xs text-center text-slate-400 mt-4">Complete days to unlock more commands in your arsenal.</p>
                        </div>
                    </div>

                    <!-- Quick Action -->
                    <div class="bg-gradient-to-r from-blue-600 to-indigo-600 rounded-xl p-8 text-white shadow-lg">
                        <h3 class="text-2xl font-bold mb-2">Ready to continue?</h3>
                        <p class="opacity-90 mb-6">Pick up where you left off or review a past concept.</p>
                        <button onclick="continueJourney()" class="bg-white text-blue-600 px-6 py-2 rounded-lg font-semibold hover:bg-blue-50 transition-colors">
                            Go to Next Unfinished Day
                        </button>
                    </div>
                </div>
            `;

            // Render Charts
            renderCharts(completedCount, beginner, intermediate, advanced);
        }

        function continueJourney() {
            const nextDay = progress.findIndex(p => !p);
            if(nextDay !== -1) loadDay(nextDay + 1);
            else loadDay(1);
        }

        function renderCharts(completed, beg, int, adv) {
            // Destroy existing charts to prevent canvas re-use errors in Chart.js
            const existingCharts = Chart.getChart('progressChart');
            if (existingCharts) existingCharts.destroy();
            const existingSkillChart = Chart.getChart('skillChart');
            if (existingSkillChart) existingSkillChart.destroy();

            // Progress Doughnut
            new Chart(document.getElementById('progressChart'), {
                type: 'doughnut',
                data: {
                    labels: ['Completed', 'Remaining'],
                    datasets: [{
                        data: [completed, 12 - completed],
                        backgroundColor: ['#2563eb', '#e2e8f0'],
                        borderWidth: 0
                    }]
                },
                options: {
                    cutout: '75%',
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } }
                }
            });

            // Skill Bar
            new Chart(document.getElementById('skillChart'), {
                type: 'bar',
                data: {
                    labels: ['Beginner', 'Intermediate', 'Advanced'],
                    datasets: [{
                        label: 'Commands Learned',
                        data: [beg, int, adv],
                        backgroundColor: ['#22c55e', '#f59e0b', '#ef4444'],
                        borderRadius: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: { y: { beginAtZero: true, grid: { display: false } }, x: { grid: { display: false } } },
                    plugins: { legend: { display: false } }
                }
            });
        }

        // --- View: Day Detail ---
        function loadDay(dayId) {
            currentDayId = dayId;
            renderNav();
            const data = curriculum.days.find(d => d.day === dayId);
            const isDone = progress[dayId - 1];

            mainContent.innerHTML = `
                <div class="max-w-5xl mx-auto pb-12">
                    <!-- Header -->
                    <div class="flex flex-col md:flex-row md:items-center justify-between gap-4 mb-8">
                        <div>
                            <div class="text-sm font-bold text-blue-600 mb-1">PHASE ${data.phase}</div>
                            <h2 class="text-3xl font-bold text-slate-900">Day ${data.day}: ${data.title}</h2>
                            <p class="text-slate-600 mt-2">${data.goal}</p>
                        </div>
                        <button onclick="toggleDayCompletion(${dayId - 1})" class="flex items-center gap-2 px-4 py-2 rounded-lg border ${isDone ? 'bg-green-50 border-green-200 text-green-700' : 'bg-white border-slate-300 text-slate-600 hover:bg-slate-50'} transition-colors">
                            <div class="w-5 h-5 rounded border flex items-center justify-center ${isDone ? 'bg-green-500 border-green-500 text-white' : 'border-slate-400'}">
                                ${isDone ? 'âœ“' : ''}
                            </div>
                            <span>${isDone ? 'Day Completed' : 'Mark as Complete'}</span>
                        </button>
                    </div>

                    <!-- Tabs -->
                    <div class="mb-6 border-b border-slate-200">
                        <div class="flex gap-6">
                            <button onclick="switchTab('concepts')" id="tab-concepts" class="tab-btn px-2 py-3 border-b-2 font-medium text-sm border-blue-600 text-blue-600">1. Concepts</button>
                            <button onclick="switchTab('commands')" id="tab-commands" class="tab-btn px-2 py-3 border-b-2 font-medium text-sm border-transparent text-slate-500 hover:text-slate-700">2. Command Lab</button>
                            <button onclick="switchTab('practice')" id="tab-practice" class="tab-btn px-2 py-3 border-b-2 font-medium text-sm border-transparent text-slate-500 hover:text-slate-700">3. Practice & Real World</button>
                        </div>
                    </div>

                    <!-- Tab Content -->
                    <div id="content-concepts" class="tab-content block animate-fade-in">
                        <div class="grid grid-cols-1 gap-6">
                            <div class="bg-blue-50 border border-blue-100 p-6 rounded-xl">
                                <h3 class="font-bold text-blue-900 mb-4 flex items-center gap-2">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                                    Core Theory
                                </h3>
                                <div class="grid gap-4">
                                    ${data.concepts.map(c => `
                                        <div class="bg-white p-4 rounded-lg shadow-sm">
                                            <div class="font-bold text-slate-800">${c.title}</div>
                                            <div class="text-slate-600 text-sm mt-1">${c.content}</div>
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                            
                            <!-- Visual Diagram (Simplified for Day 1 Architecture) -->
                            ${dayId === 1 ? `
                                <div class="bg-slate-800 p-6 rounded-xl text-white">
                                    <h4 class="font-bold mb-4 text-center">Kubernetes Architecture Visualizer</h4>
                                    <div class="flex flex-col md:flex-row gap-4 justify-center">
                                        <!-- Control Plane -->
                                        <div class="border-2 border-blue-400 p-4 rounded-lg flex-1">
                                            <div class="text-center font-mono text-blue-300 mb-2">Control Plane</div>
                                            <div class="grid gap-2">
                                                <div class="bg-slate-700 p-2 text-center rounded text-xs">API Server</div>
                                                <div class="bg-slate-700 p-2 text-center rounded text-xs">Scheduler</div>
                                                <div class="bg-slate-700 p-2 text-center rounded text-xs">Controller Mgr</div>
                                                <div class="bg-slate-700 p-2 text-center rounded text-xs">etcd</div>
                                            </div>
                                        </div>
                                        <!-- Worker Nodes -->
                                        <div class="flex-1 flex flex-col gap-2">
                                            <div class="border-2 border-green-400 p-4 rounded-lg">
                                                <div class="text-center font-mono text-green-300 mb-2">Worker Node 1</div>
                                                <div class="flex gap-2 justify-center">
                                                    <div class="bg-green-800 p-2 rounded text-xs w-16 text-center">Pod</div>
                                                    <div class="bg-green-800 p-2 rounded text-xs w-16 text-center">Pod</div>
                                                </div>
                                                <div class="mt-2 bg-slate-700 text-xs p-1 text-center">Kubelet / Kube-proxy</div>
                                            </div>
                                            <div class="border-2 border-green-400 p-4 rounded-lg">
                                                <div class="text-center font-mono text-green-300 mb-2">Worker Node 2</div>
                                                 <div class="flex gap-2 justify-center">
                                                    <div class="bg-green-800 p-2 rounded text-xs w-16 text-center">Pod</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            ` : ''}
                        </div>
                    </div>

                    <div id="content-commands" class="tab-content hidden animate-fade-in">
                        <div class="bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden">
                            <table class="w-full text-left border-collapse">
                                <thead>
                                    <tr class="bg-slate-50 border-b border-slate-200 text-slate-500 text-xs uppercase">
                                        <th class="p-4 font-semibold">Command</th>
                                        <th class="p-4 font-semibold">Level</th>
                                        <th class="p-4 font-semibold">Description</th>
                                    </tr>
                                </thead>
                                <tbody class="divide-y divide-slate-100">
                                    ${data.commands.map(c => `
                                        <tr class="hover:bg-slate-50 transition-colors">
                                            <td class="p-4 font-mono text-sm text-blue-700 font-medium">${c.cmd}</td>
                                            <td class="p-4">
                                                <span class="px-2 py-1 rounded-full text-xs font-medium 
                                                    ${c.level === 'Beginner' ? 'bg-green-100 text-green-700' : 
                                                      c.level === 'Intermediate' ? 'bg-amber-100 text-amber-700' : 
                                                      'bg-red-100 text-red-700'}">
                                                    ${c.level}
                                                </span>
                                            </td>
                                            <td class="p-4 text-slate-600 text-sm">${c.desc}</td>
                                        </tr>
                                    `).join('')}
                                </tbody>
                            </table>
                        </div>
                        <div class="mt-4 bg-slate-900 text-slate-300 p-4 rounded-lg font-mono text-sm">
                            <p class="mb-2 text-slate-500"># Pro Tip: Daily Alias</p>
                            <p>$ alias k=kubectl</p>
                        </div>
                    </div>

                    <div id="content-practice" class="tab-content hidden animate-fade-in">
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                            <!-- Checklist -->
                            <div class="space-y-6">
                                <h3 class="font-bold text-slate-800">Hands-on Checklist</h3>
                                <div class="space-y-3">
                                    ${data.practice.map((p, i) => `
                                        <label class="flex items-start gap-3 p-3 bg-white rounded-lg border border-slate-200 shadow-sm cursor-pointer hover:border-blue-300">
                                            <input type="checkbox" class="mt-1 w-4 h-4 text-blue-600 rounded border-slate-300 focus:ring-blue-500">
                                            <span class="text-sm text-slate-700">${p}</span>
                                        </label>
                                    `).join('')}
                                </div>
                            </div>

                            <!-- Interactive Scenario Cards -->
                            <div class="space-y-6">
                                <h3 class="font-bold text-slate-800">Real World Scenario</h3>
                                <div class="perspective-1000">
                                    <div class="interactive-card bg-white border border-slate-200 rounded-xl p-6 relative overflow-hidden group">
                                        <div class="absolute top-0 right-0 bg-amber-100 text-amber-800 text-xs px-2 py-1 rounded-bl-lg font-bold">SCENARIO</div>
                                        <h4 class="font-bold text-slate-800 mb-2">The Problem</h4>
                                        <p class="text-slate-600 mb-4">${data.scenario.problem}</p>
                                        
                                        <div class="border-t border-slate-100 pt-4 mt-4">
                                            <h4 class="font-bold text-green-700 mb-2 text-sm">The Solution</h4>
                                            <p class="text-slate-700 text-sm bg-green-50 p-3 rounded border border-green-100">${data.scenario.solution}</p>
                                        </div>
                                    </div>
                                </div>

                                <h3 class="font-bold text-slate-800 mt-8">Common Mistakes</h3>
                                <div class="bg-red-50 border border-red-100 rounded-xl p-4">
                                    <ul class="space-y-2">
                                        ${data.mistakes.map(m => `
                                            <li class="flex items-start gap-2 text-sm text-red-800">
                                                <span class="text-red-500 font-bold">!</span> ${m}
                                            </li>
                                        `).join('')}
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function switchTab(tabName) {
            // Update buttons
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('border-blue-600', 'text-blue-600');
                btn.classList.add('border-transparent', 'text-slate-500');
            });
            const activeBtn = document.getElementById(`tab-${tabName}`);
            activeBtn.classList.remove('border-transparent', 'text-slate-500');
            activeBtn.classList.add('border-blue-600', 'text-blue-600');

            // Update content
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.add('hidden');
            });
            document.getElementById(`content-${tabName}`).classList.remove('hidden');
        }

        // Start App
        init();

    </script>
</body>
</html>